!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("CoinsLogonWidget",[],e):"object"==typeof exports?exports.CoinsLogonWidget=e():t.CoinsLogonWidget=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){r.call(this);var e=this._assertElement(t.el);this._assertString(t.baseUrl,"baseUrl"),this._assertString(t.authCookieName,"authCookieName");this.options=i({},o.DEFAULTS,t),(this.options.hiddenLabels||this.options.horizontal)&&this.options.formGroups.forEach(function(t){t.hiddenLabel=!0}),this.options.baseUrl&&s.setOptions({baseUrl:this.options.baseUrl}),this.element=this._getElements(e),this._setState()}var r=n(1),i=n(2).assign,s=n(3),a=n(5),c=(n(6),n(7));n(9);var u={INVALID:"invalid",LOGIN:"login:init",LOGIN_ERROR:"login:error",LOGIN_ACCOUNT_EXPIRED:"login:accountExpired",LOGIN_ACCOUNT_WILL_EXPIRE:"login:accountWillExpire",LOGIN_PASSWORD_EXPIRED:"login:passwordExpired",LOGIN_PASSWORD_WILL_EXPIRE:"login:passwordWillExpire",LOGIN_SUCCESS:"login:success",LOGOUT:"logout:init",LOGOUT_ERROR:"logout:error",LOGOUT_SUCCESS:"logout:success"},l=864e5;o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype._assertElement=function(t){if(!t)throw new TypeError("Element required");if(!(t instanceof Node))throw new TypeError("Expected element to be a DOM node");return t},o.prototype._assertString=function(t,e){if(!t||"string"!=typeof t)throw new TypeError(["expected string",e?" ("+e+")":"",", received: ",t.toString()].join(""));return t},o.prototype._getElements=function(t){var e=this;return this.form=new a({formGroups:this.options.formGroups.reverse(),horizontal:this.options.horizontal,login:function(){e.emit(u.LOGIN,e.form.getFormData())},logout:function(){e.emit(u.LOGOUT)}}),t.innerHTML="",t.className=this.options.classNames.root,t.appendChild(this.form.element),t},o.prototype._setState=function(){this.on(u.LOGIN,this.login),this.on(u.LOGIN_ERROR,this.onError),this.on(u.LOGIN_ACCOUNT_EXPIRED,this.onAccountExpired),this.on(u.LOGIN_ACCOUNT_WILL_EXPIRE,this.onAccountWillExpire),this.on(u.LOGIN_PASSWORD_EXPIRED,this.onPasswordExpired),this.on(u.LOGIN_PASSWORD_WILL_EXPIRE,this.onPasswordWillExpire),this.on(u.LOGIN_SUCCESS,this.onLogin),this.on(u.LOGOUT,this.logout),this.on(u.LOGOUT_ERROR,this.onError),this.on(u.LOGOUT_SUCCESS,this.onLogout)},o.prototype.destroy=function(){this.form.destroy(),delete this.form,this.removeAllListeners(),delete this.options,delete this.element},o.prototype.login=function(t){var e=this,n=e.form.validate();return n!==!0?void e.emit(u.INVALID,n):(e.form.clearMessage(),this.form.setLoading(),s.login(t.username,t.password).done(function(t){var n=Date.parse(t.user.acctExpDate),o=Date.now(),r=Date.parse(t.user.passwordExpDate);e.form.clearLoading(),10*l>n-o?e.emit(u.LOGIN_ACCOUNT_WILL_EXPIRE,t):10*l>r-o?e.emit(u.LOGIN_PASSWORD_WILL_EXPIRE,t):e.emit(u.LOGIN_SUCCESS,t)}).fail(function(t){e.form.clearLoading(),"Password expired"===t?e.emit(u.LOGIN_PASSWORD_EXPIRED,t):"Account expired"===t?e.emit(u.LOGIN_ACCOUNT_EXPIRED,t):e.emit(u.LOGIN_ERROR,t)}))},o.prototype.logout=function(){var t=this;this.form.setLoading(),s.logout().done(function(e){t.form.clearLoading(),t.emit(u.LOGOUT_SUCCESS,e)}).fail(function(e){t.form.clearLoading(),t.emit(u.LOGOUT_ERROR,e)})},o.prototype.onAccountExpired=function(t){var e=c.callOrReturn(this.options.messages.accountExpired);this.form.setErrorMessage(e)},o.prototype.onAccountWillExpire=function(t){var e=Date.parse(t.user.acctExpDate),n=Date.now(),o=c.callOrReturn(this.options.messages.accountWillExpire,[c.formatDay((e-n)/l)]);this.form.setErrorMessage(o)},o.prototype.onPasswordExpired=function(t){var e=c.callOrReturn(this.options.messages.passwordExpired);this.form.setErrorMessage(e)},o.prototype.onPasswordWillExpire=function(t){var e=Date.parse(t.user.passwordExpDate),n=Date.now(),o=c.callOrReturn(this.options.messages.passwordWillExpire,[c.formatDay((e-n)/l)]);this.form.setErrorMessage(o)},o.prototype.onError=function(t){var e;e="undefined"!=typeof t?t.message||t.toString():"Unknown error!",this.form.setErrorMessage(e),console.error(t)},o.prototype.onLogin=function(t){var e=t.username,n=e?"Logged in as <strong>"+e+"</strong>.":"Logged in.";this.form.setToLogout(n)},o.prototype.onLogout=function(t){this.form.setToLogin()},o.prototype.onSubmit=function(t){t.preventDefault();var e;this.formGroups.forEach(function(t){var n=t.validate();n||(e=!0)}),e||(this.emit("submitted",t),this.login())},o.DEFAULTS={classNames:{root:"coins-logon-widget"},formGroups:[{inputName:"username",labelText:"Username:",placeholder:""},{inputName:"password",labelText:"Password:",placeholder:"",type:"password"}],hiddenLabels:!1,horizontal:!1,messages:{accountExpired:"Your account has expired.",accountWillExpire:function(t){return"Your account will expire in "+t+"."},passwordExpired:"Your password has expired.",passwordWillExpire:function(t){return"Your password will expire in "+t+"."}}},t.exports=o},function(t,e,n){var o;(function(){"use strict";function e(){}function r(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var s=e.prototype,a=this,c=a.EventEmitter;s.getListeners=function(t){var e,n,o=this._getEvents();if(t instanceof RegExp){e={};for(n in o)o.hasOwnProperty(n)&&t.test(n)&&(e[n]=o[n])}else e=o[t]||(o[t]=[]);return e},s.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},s.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},s.addListener=function(t,e){var n,o=this.getListenersAsObject(t),i="object"==typeof e;for(n in o)o.hasOwnProperty(n)&&-1===r(o[n],e)&&o[n].push(i?e:{listener:e,once:!1});return this},s.on=i("addListener"),s.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},s.once=i("addOnceListener"),s.defineEvent=function(t){return this.getListeners(t),this},s.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},s.removeListener=function(t,e){var n,o,i=this.getListenersAsObject(t);for(o in i)i.hasOwnProperty(o)&&(n=r(i[o],e),-1!==n&&i[o].splice(n,1));return this},s.off=i("removeListener"),s.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},s.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},s.manipulateListeners=function(t,e,n){var o,r,i=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(o=n.length;o--;)i.call(this,e,n[o]);else for(o in e)e.hasOwnProperty(o)&&(r=e[o])&&("function"==typeof r?i.call(this,o,r):s.call(this,o,r));return this},s.removeEvent=function(t){var e,n=typeof t,o=this._getEvents();if("string"===n)delete o[t];else if(t instanceof RegExp)for(e in o)o.hasOwnProperty(e)&&t.test(e)&&delete o[e];else delete this._events;return this},s.removeAllListeners=i("removeEvent"),s.emitEvent=function(t,e){var n,o,r,i,s,a=this.getListenersAsObject(t);for(i in a)if(a.hasOwnProperty(i))for(n=a[i].slice(0),r=n.length;r--;)o=n[r],o.once===!0&&this.removeListener(t,o.listener),s=o.listener.apply(this,e||[]),s===this._getOnceReturnValue()&&this.removeListener(t,o.listener);return this},s.trigger=i("emitEvent"),s.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},s.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},s._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},s._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return a.EventEmitter=c,e},o=function(){return e}.call(a,n,a,t),!(void 0!==o&&(t.exports=o))}).call(this)},function(t,e){"use strict";function n(t,e){if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),o=1;o<arguments.length;o++){var r=arguments[o];if(void 0!==r&&null!==r)for(var i=Object.keys(Object(r)),s=0,a=i.length;a>s;s++){var c=i[s],u=Object.getOwnPropertyDescriptor(r,c);void 0!==u&&u.enumerable&&(n[c]=r[c])}}return n}function o(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:n})}t.exports={assign:n,polyfill:o}},function(t,e,n){"use strict";function o(){return JSON.parse(localStorage.getItem(g))}function r(t){return localStorage.setItem(g,JSON.stringify(t)),o()}function i(t,e,n){var o=m.client.header(t,e,{credentials:n});return{Authorization:o.field}}function s(t){var e=c();return e.baseUrl+t}function a(){var t="REMOVED",e=".mrn.org",n="/",o=c().authCookieName;document.cookie=[o,"=",t,"; Path=",n,"; Domain=",e,";"].join("")}function c(){return y}function u(t){return d(y,t),c()}function l(t){return t.data[0]}function h(t){var e,n=t.statusText;return t.responseText&&(e=JSON.parse(t.responseText)||{},e=(e.error||{}).message||""),e||n||"Unknown error"}function p(t,e){var n=jQuery.Deferred();return jQuery.ajax({data:{password:btoa(e),username:btoa(t)},dataType:"json",type:"POST",url:s("/auth/keys"),xhrFields:{withCredentials:!0}}).done(function(t){var e=l(t);r(e),n.resolve(e)}).fail(function(t){n.reject(h(t))}),n.promise()}function f(){var t=jQuery.Deferred(),e=o(),n="DELETE",c=s("/auth/keys/"+e.id);return jQuery.ajax({dataType:"json",headers:i(c,n,e),type:n,url:c,xhrFields:{withCredentials:!0}}).done(function(e){t.resolve(l(e))}).fail(function(e){t.reject(h(e))}).always(function(){return a(),r({date:Date.now(),status:"logged out"})}),t.promise()}var d=n(2).assign,m=n(4),g="COINS_AUTH_CREDENTIALS",y={baseUrl:""};t.exports={getOptions:c,setOptions:u,login:p,logout:f}},function(t,e){var n={internals:{}};n.client={header:function(t,e,o){var r={field:"",artifacts:{}};if(!t||"string"!=typeof t&&"object"!=typeof t||!e||"string"!=typeof e||!o||"object"!=typeof o)return r.err="Invalid argument type",r;var i=o.timestamp||n.utils.now(o.localtimeOffsetMsec),s=o.credentials;if(!(s&&s.id&&s.key&&s.algorithm))return r.err="Invalid credentials object",r;if(-1===n.crypto.algorithms.indexOf(s.algorithm))return r.err="Unknown algorithm",r;"string"==typeof t&&(t=n.utils.parseUri(t));var a={ts:i,nonce:o.nonce||n.utils.randomString(6),method:e,resource:t.resource,host:t.host,port:t.port,hash:o.hash,ext:o.ext,app:o.app,dlg:o.dlg};r.artifacts=a,a.hash||!o.payload&&""!==o.payload||(a.hash=n.crypto.calculatePayloadHash(o.payload,s.algorithm,o.contentType));var c=n.crypto.calculateMac("header",s,a),u=null!==a.ext&&void 0!==a.ext&&""!==a.ext,l='Hawk id="'+s.id+'", ts="'+a.ts+'", nonce="'+a.nonce+(a.hash?'", hash="'+a.hash:"")+(u?'", ext="'+n.utils.escapeHeaderAttribute(a.ext):"")+'", mac="'+c+'"';return a.app&&(l+=', app="'+a.app+(a.dlg?'", dlg="'+a.dlg:"")+'"'),r.field=l,r},bewit:function(t,e){if(!t||"string"!=typeof t||!e||"object"!=typeof e||!e.ttlSec)return"";e.ext=null===e.ext||void 0===e.ext?"":e.ext;var o=n.utils.now(e.localtimeOffsetMsec),r=e.credentials;if(!(r&&r.id&&r.key&&r.algorithm))return"";if(-1===n.crypto.algorithms.indexOf(r.algorithm))return"";t=n.utils.parseUri(t);var i=o+e.ttlSec,s=n.crypto.calculateMac("bewit",r,{ts:i,nonce:"",method:"GET",resource:t.resource,host:t.host,port:t.port,ext:e.ext}),a=r.id+"\\"+i+"\\"+s+"\\"+e.ext;return n.utils.base64urlEncode(a)},authenticate:function(t,e,o,r){r=r||{};var i=function(e){return t.getResponseHeader?t.getResponseHeader(e):t.getHeader(e)},s=i("www-authenticate");if(s){var a=n.utils.parseAuthorizationHeader(s,["ts","tsm","error"]);if(!a)return!1;if(a.ts){var c=n.crypto.calculateTsMac(a.ts,e);if(c!==a.tsm)return!1;n.utils.setNtpOffset(a.ts-Math.floor((new Date).getTime()/1e3))}}var u=i("server-authorization");if(!u&&!r.required)return!0;var l=n.utils.parseAuthorizationHeader(u,["mac","ext","hash"]);if(!l)return!1;var h={ts:o.ts,nonce:o.nonce,method:o.method,resource:o.resource,host:o.host,port:o.port,hash:l.hash,ext:l.ext,app:o.app,dlg:o.dlg},p=n.crypto.calculateMac("response",e,h);if(p!==l.mac)return!1;if(!r.payload&&""!==r.payload)return!0;if(!l.hash)return!1;var f=n.crypto.calculatePayloadHash(r.payload,e.algorithm,i("content-type"));return f===l.hash},message:function(t,e,o,r){if(!t||"string"!=typeof t||!e||"number"!=typeof e||null===o||void 0===o||"string"!=typeof o||!r||"object"!=typeof r)return null;var i=r.timestamp||n.utils.now(r.localtimeOffsetMsec),s=r.credentials;if(!(s&&s.id&&s.key&&s.algorithm))return null;if(-1===n.crypto.algorithms.indexOf(s.algorithm))return null;var a={ts:i,nonce:r.nonce||n.utils.randomString(6),host:t,port:e,hash:n.crypto.calculatePayloadHash(o,s.algorithm)},c={id:s.id,ts:a.ts,nonce:a.nonce,hash:a.hash,mac:n.crypto.calculateMac("message",s,a)};return c},authenticateTimestamp:function(t,e,o){var r=n.crypto.calculateTsMac(t.ts,e);return r!==t.tsm?!1:(o!==!1&&n.utils.setNtpOffset(t.ts-Math.floor((new Date).getTime()/1e3)),!0)}},n.crypto={headerVersion:"1",algorithms:["sha1","sha256"],calculateMac:function(t,e,r){var i=n.crypto.generateNormalizedString(t,r),s=o["Hmac"+e.algorithm.toUpperCase()](i,e.key);return s.toString(o.enc.Base64)},generateNormalizedString:function(t,e){var o="hawk."+n.crypto.headerVersion+"."+t+"\n"+e.ts+"\n"+e.nonce+"\n"+(e.method||"").toUpperCase()+"\n"+(e.resource||"")+"\n"+e.host.toLowerCase()+"\n"+e.port+"\n"+(e.hash||"")+"\n";return e.ext&&(o+=e.ext.replace("\\","\\\\").replace("\n","\\n")),o+="\n",e.app&&(o+=e.app+"\n"+(e.dlg||"")+"\n"),o},calculatePayloadHash:function(t,e,r){var i=o.algo[e.toUpperCase()].create();return i.update("hawk."+n.crypto.headerVersion+".payload\n"),i.update(n.utils.parseContentType(r)+"\n"),i.update(t),i.update("\n"),i.finalize().toString(o.enc.Base64)},calculateTsMac:function(t,e){var r=o["Hmac"+e.algorithm.toUpperCase()]("hawk."+n.crypto.headerVersion+".ts\n"+t+"\n",e.key);return r.toString(o.enc.Base64)}},n.internals.LocalStorage=function(){this._cache={},this.length=0,this.getItem=function(t){return this._cache.hasOwnProperty(t)?String(this._cache[t]):null},this.setItem=function(t,e){this._cache[t]=String(e),this.length=Object.keys(this._cache).length},this.removeItem=function(t){delete this._cache[t],this.length=Object.keys(this._cache).length},this.clear=function(){this._cache={},this.length=0},this.key=function(t){return Object.keys(this._cache)[t||0]}},n.utils={storage:new n.internals.LocalStorage,setStorage:function(t){var e=n.utils.storage.getItem("hawk_ntp_offset");n.utils.storage=t,e&&n.utils.setNtpOffset(e)},setNtpOffset:function(t){try{n.utils.storage.setItem("hawk_ntp_offset",t)}catch(e){console.error("[hawk] could not write to storage."),console.error(e)}},getNtpOffset:function(){var t=n.utils.storage.getItem("hawk_ntp_offset");return t?parseInt(t,10):0},now:function(t){return Math.floor(((new Date).getTime()+(t||0))/1e3)+n.utils.getNtpOffset()},escapeHeaderAttribute:function(t){return t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},parseContentType:function(t){return t?t.split(";")[0].replace(/^\s+|\s+$/g,"").toLowerCase():""},parseAuthorizationHeader:function(t,e){if(!t)return null;var n=t.match(/^(\w+)(?:\s+(.*))?$/);if(!n)return null;var o=n[1];if("hawk"!==o.toLowerCase())return null;var r=n[2];if(!r)return null;var i={},s=r.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g,function(t,n,o){return-1===e.indexOf(n)||null===o.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/)||i.hasOwnProperty(n)?void 0:(i[n]=o,"")});return""!==s?null:i},randomString:function(t){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=e.length,o=[],r=0;t>r;++r)o[r]=e[Math.floor(Math.random()*n)];return o.join("")},uriRegex:/^([^:]+)\:\/\/(?:[^@]*@)?([^\/:]+)(?:\:(\d+))?([^#]*)(?:#.*)?$/,parseUri:function(t){var e=t.match(n.utils.uriRegex);if(!e)return{host:"",port:"",resource:""};var o=e[1].toLowerCase(),r={host:e[2],port:e[3]||("http"===o?"80":"https"===o?"443":""),resource:e[4]};return r},base64urlEncode:function(t){var e=o.enc.Utf8.parse(t),n=o.enc.Base64.stringify(e);return n.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}};var o=o||function(t,e){var n={},o=n.lib={},r=function(){},i=o.Base={extend:function(t){r.prototype=this;var e=new r;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=o.WordArray=i.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,n=t.words,o=this.sigBytes;if(t=t.sigBytes,this.clamp(),o%4)for(var r=0;t>r;r++)e[o+r>>>2]|=(n[r>>>2]>>>24-8*(r%4)&255)<<24-8*((o+r)%4);else if(65535<n.length)for(r=0;t>r;r+=4)e[o+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-8*(n%4),e.length=t.ceil(n/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],o=0;e>o;o+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),a=n.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],o=0;t>o;o++){var r=e[o>>>2]>>>24-8*(o%4)&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],o=0;e>o;o+=2)n[o>>>3]|=parseInt(t.substr(o,2),16)<<24-4*(o%8);return new s.init(n,e/2)}},u=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],o=0;t>o;o++)n.push(String.fromCharCode(e[o>>>2]>>>24-8*(o%4)&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],o=0;e>o;o++)n[o>>>2]|=(255&t.charCodeAt(o))<<24-8*(o%4);return new s.init(n,e)}},l=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},h=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,o=n.words,r=n.sigBytes,i=this.blockSize,a=r/(4*i),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0);if(e=a*i,r=t.min(4*e,r),e){for(var c=0;e>c;c+=i)this._doProcessBlock(o,c);c=o.splice(0,e),n.sigBytes-=r}return new s.init(c,r)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});o.Hasher=h.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new p.HMAC.init(t,n).finalize(e)}}});var p=n.algo={};return n}(Math);!function(){var t=o,e=t.lib,n=e.WordArray,r=e.Hasher,i=[],e=t.algo.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,o=n[0],r=n[1],s=n[2],a=n[3],c=n[4],u=0;80>u;u++){if(16>u)i[u]=0|t[e+u];else{var l=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=l<<1|l>>>31}l=(o<<5|o>>>27)+c+i[u],l=20>u?l+((r&s|~r&a)+1518500249):40>u?l+((r^s^a)+1859775393):60>u?l+((r&s|r&a|s&a)-1894007588):l+((r^s^a)-899497514),c=a,a=s,s=r<<30|r>>>2,r=o,o=l}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return e[o>>>5]|=128<<24-o%32,e[(o+64>>>9<<4)+14]=Math.floor(n/4294967296),e[(o+64>>>9<<4)+15]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=r._createHelper(e),t.HmacSHA1=r._createHmacHelper(e)}(),function(t){for(var e=o,n=e.lib,r=n.WordArray,i=n.Hasher,n=e.algo,s=[],a=[],c=function(t){return 4294967296*(t-(0|t))|0},u=2,l=0;64>l;){var h;t:{h=u;for(var p=t.sqrt(h),f=2;p>=f;f++)if(!(h%f)){h=!1;break t}h=!0}h&&(8>l&&(s[l]=c(t.pow(u,.5))),a[l]=c(t.pow(u,1/3)),l++),u++}var d=[],n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],p=0;64>p;p++){if(16>p)d[p]=0|t[e+p];else{var f=d[p-15],m=d[p-2];d[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+d[p-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+d[p-16]}f=h+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+a[p]+d[p],m=((o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22))+(o&r^o&i^r&i),h=l,l=u,u=c,c=s+f|0,s=i,i=r,r=o,o=f+m|0}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0,n[5]=n[5]+u|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,o=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[(r+64>>>9<<4)+14]=t.floor(o/4294967296),n[(r+64>>>9<<4)+15]=o,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(n),e.HmacSHA256=i._createHmacHelper(n)}(Math),function(){var t=o,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var o=t.blockSize,r=4*o;n.sigBytes>r&&(n=t.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),s=this._iKey=n.clone(),a=i.words,c=s.words,u=0;o>u;u++)a[u]^=1549556828,c[u]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t=o,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,o=this._map;t.clamp(),t=[];for(var r=0;n>r;r+=3)for(var i=(e[r>>>2]>>>24-8*(r%4)&255)<<16|(e[r+1>>>2]>>>24-8*((r+1)%4)&255)<<8|e[r+2>>>2]>>>24-8*((r+2)%4)&255,s=0;4>s&&n>r+.75*s;s++)t.push(o.charAt(i>>>6*(3-s)&63));if(e=o.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,o=this._map,r=o.charAt(64);r&&(r=t.indexOf(r),-1!=r&&(n=r));for(var r=[],i=0,s=0;n>s;s++)if(s%4){var a=o.indexOf(t.charAt(s-1))<<2*(s%4),c=o.indexOf(t.charAt(s))>>>6-2*(s%4);r[i>>>2]|=(a|c)<<24-8*(i%4),i++}return e.create(r,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.crypto.internals=o,"undefined"!=typeof t&&t.exports&&(t.exports=n)},function(t,e,n){"use strict";function o(t){t=t||{},this.options=r({},o.DEFAULTS,t),this.element=this._getElements(),this._setState(this.options.initialState)}var r=n(2).assign,i=n(6),s=n(7);o.prototype._getElements=function(){var t=document.createElement("button"),e=document.createElement("form");return e.className=this.options.classNames.form,this.options.horizontal&&e.classList.add(this.options.classNames.horizontal),e.method="post",e.addEventListener("submit",this._submitHandler.bind(this),!1),t.className=this.options.classNames.button+" "+this.options.classNames.right,t.type="submit",e.appendChild(this._getIndicatorElements()),e.appendChild(t),e},o.prototype._getIndicatorElements=function(){var t=document.createElement("div"),e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","title"),o=document.createElementNS("http://www.w3.org/2000/svg","circle"),r={cx:20,cy:20,r:8,fill:"none","stroke-width":2,"stroke-miterlimit":4};t.className=this.options.classNames.indicator,t.setAttribute("aria-hidden",!0),n.textContent="Loadingâ€¦";for(var i in r)r.hasOwnProperty(i)&&o.setAttribute(i,r[i]);return e.appendChild(n),e.appendChild(o),t.appendChild(e),t},o.prototype._setState=function(t){"undefined"==typeof this._state&&(this._state={});var e=this,n=this.element.querySelector("."+this.options.classNames.button),o=this.element.querySelector("."+this.options.classNames.indicator),i=this.element.querySelector("."+this.options.classNames.notification),a=this.element.querySelector("."+this.options.classNames.status);r(this._state,t),i&&!t.notification?s.removeElement(i):!i&&t.notification&&(i=document.createElement("div"),i.className=this.options.classNames.notification,i.setAttribute("role","alert"),this.element.insertBefore(i,this.element.firstChild)),i&&t.notification&&(t.notification instanceof Node?i.appendChild(t.notification):i.innerHTML=t.notification,i.classList.remove(this.options.classNames.notificationError),i.classList.remove(this.options.classNames.notificationSuccess),t.error?i.classList.add(this.options.classNames.notificationError):t.success&&i.classList.add(this.options.classNames.notificationSuccess)),this._state.loading?(this.element.classList.add(this.options.classNames.loading),o.setAttribute("aria-hidden",!1)):(this.element.classList.remove(this.options.classNames.loading),o.setAttribute("aria-hidden",!0)),this._state.login?(this.formGroups||(this._setFormGroups(),this.formGroups.map(function(t){return t.element}).reverse().forEach(function(t){e.element.insertBefore(t,o)})),a&&this.element.removeChild(a),n.textContent=this.options.buttonLoginText,n.classList.remove(this.options.classNames.buttonSecondary),n.classList.add(this.options.classNames.buttonPrimary)):(this.formGroups&&this._removeFormGroups(),a||(a=document.createElement("p"),a.className=this.options.classNames.status,this.element.insertBefore(a,this.element.firstChild)),a.innerHTML=this._state.status||this.options.statusText,n.textContent=this.options.buttonLogoutText,n.classList.remove(this.options.classNames.buttonPrimary),n.classList.add(this.options.classNames.buttonSecondary))},o.prototype._submitHandler=function(t){t.preventDefault();var e=this.options.login,n=this.options.logout;this._state.login&&e instanceof Function?e(t):n instanceof Function&&n(t)},o.prototype._setFormGroups=function(){this.formGroups=this.options.formGroups.map(function(t){return new i(t)})},o.prototype._removeFormGroups=function(){this.formGroups.forEach(function(t){t.destroy()}),delete this.formGroups},o.prototype.clearMessage=function(){this._setState({error:null,notification:null,success:null})},o.prototype.destroy=function(){this.element.removeEventListener("submit",this._submitHandler,!1),this._removeFormGroups(),s.removeElement(this.element),delete this._state,delete this.options},o.prototype.getFormData=function(){return this.formGroups.reduce(function(t,e){var n=e.getName();return n in t||(t[n]=e.getValue()),t},{})},o.prototype.setErrorMessage=function(t){this._setState({error:!0,notification:t})},o.prototype.setLoading=function(){this._setState({loading:!0})},o.prototype.clearLoading=function(){this._setState({loading:!1})},o.prototype.setSuccessMessage=function(t){this._setState({notification:t,success:!0})},o.prototype.setToLogin=function(t){this._setState({login:!0})},o.prototype.setToLogout=function(t){this._setState({login:!1,status:t||null})},o.prototype.validate=function(){var t,e;return this.formGroups?(e=this.formGroups.map(function(t){return t.validate()}),t=e.every(function(t){return t===!0}),t?!0:e):void 0},o.DEFAULTS={buttonLoginText:"Log In",buttonLogoutText:"Log Out",classNames:{button:"coins-logon-widget-button",buttonPrimary:"coins-logon-widget-button-primary",buttonSecondary:"coins-logon-widget-button-secondary",form:"coins-logon-widget-form",horizontal:"coins-logon-widget-form-horizontal",indicator:"coins-logon-widget-indicator",loading:"coins-logon-widget-form-loading",notification:"coins-logon-widget-notification",notificationError:"coins-logon-widget-notification-error",notificationSuccess:"coins-logon-widget-notification-success",right:"coins-logon-widget-right",status:"coins-logon-widget-status"},initialState:{error:null,login:!0,notification:null,success:null},statusText:"Logged in"},t.exports=o},function(t,e,n){"use strict";function o(t){t=t||{},this.options=r({},o.DEFAULTS,t),this.element=this._getElements(),this._setState()}var r=n(2).assign,i=n(7);o.prototype._getElements=function(){var t=this.options.classNames,e=document.createElement("div"),n=i.uniqueId("coins-logon-widget-"),o=document.createElement("input"),r=document.createElement("label");return e.className=t.formGroup,r.className=t.label,r.setAttribute("for",n),r.textContent=this.options.labelText,o.className=t.input,o.id=n,o.name=this.options.inputName,o.type=this.options.type,this.options.hiddenLabel?(r.classList.add(t.hidden),o.placeholder=this.options.placeholder||this.options.labelText):(this.options.placeholder&&(o.placeholder=this.options.placeholder),this.options.required&&o.setAttribute("aria-required",!0)),e.appendChild(r),e.appendChild(o),e},o.prototype._setState=function(t){"undefined"==typeof this._state&&(this._state={});var e=this,n=this.element,o=this.options.classNames,s=n.querySelector("."+o.input),a=n.querySelector("."+o.icon),c=n.querySelector("."+o.message);r(this._state,t),this._state.message||this._state.error||this._state.success?(a||(a=document.createElement("span"),a.className=this.options.classNames.icon,a.setAttribute("aria-hidden",!0),n.appendChild(a)),!c&&this._state.message?(c=document.createElement("span"),c.className=this.options.classNames.message,n.appendChild(c)):this._state.message||c.parentNode.removeChild(c),c&&this._state.message&&(c.textContent=this._state.message),this._state.error?(n.classList.remove(o.success),n.classList.add(o.error)):this._state.success&&(n.classList.remove(o.error),n.classList.add(o.success)),i.once(s,"keydown",function(){e._setState({error:null,message:null,success:null})})):(a&&a.parentNode.removeChild(a),c&&c.parentNode.removeChild(c),n.classList.remove(o.error),n.classList.remove(o.success))},o.prototype.destroy=function(){i.removeElement(this.element),delete this._state,delete this.options},o.prototype.getName=function(){return this.options.inputName},o.prototype.getValue=function(){return this.element.querySelector("input").value},o.prototype.validate=function(){var t,e=this.getValue(),n=this.options.validate;return this.options.required&&n instanceof Function&&(t=n(e),t!==!0)?(this._setState({error:!0,message:t}),!1):!0},o.DEFAULTS={classNames:{error:"coins-logon-widget-form-group-error",formGroup:"coins-logon-widget-form-group",hidden:"coins-logon-widget-visuallyhidden",icon:"coins-logon-widget-icon",input:"coins-logon-widget-input",label:"coins-logon-widget-label",message:"coins-logon-widget-input-message",success:"coins-logon-widget-form-group-success"},hiddenLabel:!1,inputName:"name",labelText:"Name:",placeholder:"",required:!0,type:"text",validate:function(t){return""===t.trim()?"Field empty!":!0}},t.exports=o},function(t,e,n){"use strict";function o(t,e){return t instanceof Function?t.apply(null,e):t}function r(t){return 1>t?"less than 1 day":""+Math.ceil(t)+" days"}function i(t,e,n){function o(){n.apply(null,arguments),t.removeEventListener(e,o,!1)}t.addEventListener(e,o,!1)}function s(t){if(t)for(;t.lastChild;)t.removeChild(t.lastChild);t.parentNode&&t.parentNode.removeChild(t)}function a(t){return"string"!=typeof t&&(t=""),t+u.generate()}var c=n(8),u=new c;t.exports={callOrReturn:o,formatDay:r,once:i,removeElement:s,uniqueId:a}},function(t,e,n){var o,r;!function(){"use strict";function n(t){return this instanceof n==!1?new n(t):(this.useDate=t===!0,void this.reset())}n.prototype.generate=function(){var t;return this.useDate===!1?this.previous++:(t=Date.now(),t<=this.previous?t=++this.previous:this.previous=t,
t)},n.prototype.reset=function(){this.previous=0},"object"==typeof t&&"object"==typeof t.exports?t.exports=n:(o=[],r=function(){return n}.apply(e,o),!(void 0!==r&&(t.exports=r)))}()},function(t,e,n){t.exports=function(){Function.prototype.bind||(Function.prototype.bind=n(10))}()},function(t,e){var n="Function.prototype.bind called on incompatible ",o=Array.prototype.slice,r=Object.prototype.toString,i="[object Function]";t.exports=function(t){var e=this;if("function"!=typeof e||r.call(e)!==i)throw new TypeError(n+e);for(var s=o.call(arguments,1),a=function(){if(this instanceof h){var n=e.apply(this,s.concat(o.call(arguments)));return Object(n)===n?n:this}return e.apply(t,s.concat(o.call(arguments)))},c=Math.max(0,e.length-s.length),u=[],l=0;c>l;l++)u.push("$"+l);var h=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(a);if(e.prototype){var p=function(){};p.prototype=e.prototype,h.prototype=new p,p.prototype=null}return h}}])});