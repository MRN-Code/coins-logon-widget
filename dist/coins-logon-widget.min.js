(function(){"use strict";function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define("wolfy87-eventemitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.EventEmitter=a}).call(this),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("es6-object-assign",[],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.ObjectAssign=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(void 0!==e&&null!==e)for(var f=Object.keys(Object(e)),g=0,h=f.length;h>g;g++){var i=f[g],j=Object.getOwnPropertyDescriptor(e,i);void 0!==j&&j.enumerable&&(c[i]=e[i])}}return c}function e(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:d})}b.exports={assign:d,polyfill:e}},{}]},{},[1])(1)});var hawk={internals:{}};hawk.client={header:function(a,b,c){var d={field:"",artifacts:{}};if(!a||"string"!=typeof a&&"object"!=typeof a||!b||"string"!=typeof b||!c||"object"!=typeof c)return d.err="Invalid argument type",d;var e=c.timestamp||hawk.utils.now(c.localtimeOffsetMsec),f=c.credentials;if(!(f&&f.id&&f.key&&f.algorithm))return d.err="Invalid credentials object",d;if(-1===hawk.crypto.algorithms.indexOf(f.algorithm))return d.err="Unknown algorithm",d;"string"==typeof a&&(a=hawk.utils.parseUri(a));var g={ts:e,nonce:c.nonce||hawk.utils.randomString(6),method:b,resource:a.relative,host:a.hostname,port:a.port,hash:c.hash,ext:c.ext,app:c.app,dlg:c.dlg};d.artifacts=g,g.hash||!c.payload&&""!==c.payload||(g.hash=hawk.crypto.calculatePayloadHash(c.payload,f.algorithm,c.contentType));var h=hawk.crypto.calculateMac("header",f,g),i=null!==g.ext&&void 0!==g.ext&&""!==g.ext,j='Hawk id="'+f.id+'", ts="'+g.ts+'", nonce="'+g.nonce+(g.hash?'", hash="'+g.hash:"")+(i?'", ext="'+hawk.utils.escapeHeaderAttribute(g.ext):"")+'", mac="'+h+'"';return g.app&&(j+=', app="'+g.app+(g.dlg?'", dlg="'+g.dlg:"")+'"'),d.field=j,d},bewit:function(a,b){if(!a||"string"!=typeof a||!b||"object"!=typeof b||!b.ttlSec)return"";b.ext=null===b.ext||void 0===b.ext?"":b.ext;var c=hawk.utils.now(b.localtimeOffsetMsec),d=b.credentials;if(!(d&&d.id&&d.key&&d.algorithm))return"";if(-1===hawk.crypto.algorithms.indexOf(d.algorithm))return"";a=hawk.utils.parseUri(a);var e=c+b.ttlSec,f=hawk.crypto.calculateMac("bewit",d,{ts:e,nonce:"",method:"GET",resource:a.relative,host:a.hostname,port:a.port,ext:b.ext}),g=d.id+"\\"+e+"\\"+f+"\\"+b.ext;return hawk.utils.base64urlEncode(g)},authenticate:function(a,b,c,d){d=d||{};var e=function(b){return a.getResponseHeader?a.getResponseHeader(b):a.getHeader(b)},f=e("www-authenticate");if(f){var g=hawk.utils.parseAuthorizationHeader(f,["ts","tsm","error"]);if(!g)return!1;if(g.ts){var h=hawk.crypto.calculateTsMac(g.ts,b);if(h!==g.tsm)return!1;hawk.utils.setNtpOffset(g.ts-Math.floor((new Date).getTime()/1e3))}}var i=e("server-authorization");if(!i&&!d.required)return!0;var j=hawk.utils.parseAuthorizationHeader(i,["mac","ext","hash"]);if(!j)return!1;var k={ts:c.ts,nonce:c.nonce,method:c.method,resource:c.resource,host:c.host,port:c.port,hash:j.hash,ext:j.ext,app:c.app,dlg:c.dlg},l=hawk.crypto.calculateMac("response",b,k);if(l!==j.mac)return!1;if(!d.payload&&""!==d.payload)return!0;if(!j.hash)return!1;var m=hawk.crypto.calculatePayloadHash(d.payload,b.algorithm,e("content-type"));return m===j.hash},message:function(a,b,c,d){if(!a||"string"!=typeof a||!b||"number"!=typeof b||null===c||void 0===c||"string"!=typeof c||!d||"object"!=typeof d)return null;var e=d.timestamp||hawk.utils.now(d.localtimeOffsetMsec),f=d.credentials;if(!(f&&f.id&&f.key&&f.algorithm))return null;if(-1===hawk.crypto.algorithms.indexOf(f.algorithm))return null;var g={ts:e,nonce:d.nonce||hawk.utils.randomString(6),host:a,port:b,hash:hawk.crypto.calculatePayloadHash(c,f.algorithm)},h={id:f.id,ts:g.ts,nonce:g.nonce,hash:g.hash,mac:hawk.crypto.calculateMac("message",f,g)};return h},authenticateTimestamp:function(a,b,c){var d=hawk.crypto.calculateTsMac(a.ts,b);return d!==a.tsm?!1:(c!==!1&&hawk.utils.setNtpOffset(a.ts-Math.floor((new Date).getTime()/1e3)),!0)}},hawk.crypto={headerVersion:"1",algorithms:["sha1","sha256"],calculateMac:function(a,b,c){var d=hawk.crypto.generateNormalizedString(a,c),e=CryptoJS["Hmac"+b.algorithm.toUpperCase()](d,b.key);return e.toString(CryptoJS.enc.Base64)},generateNormalizedString:function(a,b){var c="hawk."+hawk.crypto.headerVersion+"."+a+"\n"+b.ts+"\n"+b.nonce+"\n"+(b.method||"").toUpperCase()+"\n"+(b.resource||"")+"\n"+b.host.toLowerCase()+"\n"+b.port+"\n"+(b.hash||"")+"\n";return b.ext&&(c+=b.ext.replace("\\","\\\\").replace("\n","\\n")),c+="\n",b.app&&(c+=b.app+"\n"+(b.dlg||"")+"\n"),c},calculatePayloadHash:function(a,b,c){var d=CryptoJS.algo[b.toUpperCase()].create();return d.update("hawk."+hawk.crypto.headerVersion+".payload\n"),d.update(hawk.utils.parseContentType(c)+"\n"),d.update(a),d.update("\n"),d.finalize().toString(CryptoJS.enc.Base64)},calculateTsMac:function(a,b){var c=CryptoJS["Hmac"+b.algorithm.toUpperCase()]("hawk."+hawk.crypto.headerVersion+".ts\n"+a+"\n",b.key);return c.toString(CryptoJS.enc.Base64)}},hawk.internals.LocalStorage=function(){this._cache={},this.length=0,this.getItem=function(a){return this._cache.hasOwnProperty(a)?String(this._cache[a]):null},this.setItem=function(a,b){this._cache[a]=String(b),this.length=Object.keys(this._cache).length},this.removeItem=function(a){delete this._cache[a],this.length=Object.keys(this._cache).length},this.clear=function(){this._cache={},this.length=0},this.key=function(a){return Object.keys(this._cache)[a||0]}},hawk.utils={storage:new hawk.internals.LocalStorage,setStorage:function(a){var b=hawk.utils.storage.getItem("hawk_ntp_offset");hawk.utils.storage=a,b&&hawk.utils.setNtpOffset(b)},setNtpOffset:function(a){try{hawk.utils.storage.setItem("hawk_ntp_offset",a)}catch(b){console.error("[hawk] could not write to storage."),console.error(b)}},getNtpOffset:function(){var a=hawk.utils.storage.getItem("hawk_ntp_offset");return a?parseInt(a,10):0},now:function(a){return Math.floor(((new Date).getTime()+(a||0))/1e3)+hawk.utils.getNtpOffset()},escapeHeaderAttribute:function(a){return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},parseContentType:function(a){return a?a.split(";")[0].replace(/^\s+|\s+$/g,"").toLowerCase():""},parseAuthorizationHeader:function(a,b){if(!a)return null;var c=a.match(/^(\w+)(?:\s+(.*))?$/);if(!c)return null;var d=c[1];if("hawk"!==d.toLowerCase())return null;var e=c[2];if(!e)return null;var f={},g=e.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g,function(a,c,d){return-1===b.indexOf(c)||null===d.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/)||f.hasOwnProperty(c)?void 0:(f[c]=d,"")});return""!==g?null:f},randomString:function(a){for(var b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",c=b.length,d=[],e=0;a>e;++e)d[e]=b[Math.floor(Math.random()*c)];return d.join("")},parseUri:function(a){for(var b=["source","protocol","authority","userInfo","user","password","hostname","port","resource","relative","pathname","directory","file","query","fragment"],c=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?)(?:#(.*))?)/,d=a.match(c),e={},f=0,g=b.length;g>f;++f)e[b[f]]=d[f]||"";return""===e.port&&(e.port="http"===e.protocol.toLowerCase()?"80":"https"===e.protocol.toLowerCase()?"443":""),e},base64urlEncode:function(a){var b=CryptoJS.enc.Utf8.parse(a),c=CryptoJS.enc.Base64.stringify(b);return c.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}};var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,e=[],b=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)e[j]=0|a[b+j];else{var k=e[j-3]^e[j-8]^e[j-14]^e[j-16];e[j]=k<<1|k>>>31}k=(d<<5|d>>>27)+i+e[j],k=20>j?k+((f&g|~f&h)+1518500249):40>j?k+((f^g^h)+1859775393):60>j?k+((f&g|f&h|g&h)-1894007588):k+((f^g^h)-899497514),i=h,h=g,g=f<<30|f>>>2,f=d,d=k}c[0]=c[0]+d|0,c[1]=c[1]+f|0,c[2]=c[2]+g|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA1=d._createHelper(b),a.HmacSHA1=d._createHmacHelper(b)}(),function(a){for(var b=CryptoJS,c=b.lib,d=c.WordArray,e=c.Hasher,c=b.algo,f=[],g=[],h=function(a){return 4294967296*(a-(0|a))|0},i=2,j=0;64>j;){var k;a:{k=i;for(var l=a.sqrt(k),m=2;l>=m;m++)if(!(k%m)){k=!1;break a}k=!0}k&&(8>j&&(f[j]=h(a.pow(i,.5))),g[j]=h(a.pow(i,1/3)),j++),i++}var n=[],c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=0;64>m;m++){if(16>m)n[m]=0|a[b+m];else{var o=n[m-15],p=n[m-2];n[m]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+n[m-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[m-16]}o=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+g[m]+n[m],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=h+o|0,h=f,f=e,e=d,d=o+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA256=e._createHelper(c),b.HmacSHA256=e._createHmacHelper(c)}(Math),function(){var a=CryptoJS,b=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,c){a=this._hasher=new a.init,"string"==typeof c&&(c=b.parse(c));var d=a.blockSize,e=4*d;c.sigBytes>e&&(c=a.finalize(c)),c.clamp();for(var f=this._oKey=c.clone(),g=this._iKey=c.clone(),h=f.words,i=g.words,j=0;d>j;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),hawk.crypto.internals=CryptoJS,"undefined"!=typeof module&&module.exports&&(module.exports=hawk),function(a,b){"function"==typeof define&&define.amd?define("coins-logon-widget/scripts/lib/auth",["es6-object-assign","hawk"],function(a,c){return b(a.assign,c)}):"object"==typeof module&&module.exports?module.exports=b(require("es6-object-assign").assign,require("hawk/lib/browser")):(a.CoinsLogonWidget=a.CoinsLogonWidget||{},a.CoinsLogonWidget.Auth=b(a.ObjectAssign.assign,hawk))}(this,function(a){"use strict";function b(){return JSON.parse(localStorage.getItem(l))}function c(a){return localStorage.setItem(l,JSON.stringify(a)),b()}function d(a,c,d){var e=hawk.client.header(a,c,{credentials:b()});return{Authorization:e.field}}function e(a){var b=f();return b.baseUrl+a}function f(){return m}function g(b){return a(m,b),f()}function h(a){return a.data[0]}function i(a){var b,c=a.statusText;return a.responseText&&(b=JSON.parse(a.responseText)||{},b=(b.error||{}).message||""),b||c||"Unknown error"}function j(a,b){var d=jQuery.Deferred();return jQuery.ajax({data:{password:btoa(b),username:btoa(a)},dataType:"json",type:"POST",url:e("/auth/keys"),xhrFields:{withCredentials:!0}}).done(function(a){var b=h(a);c(b),d.resolve(b)}).fail(function(a){d.reject(i(a))}),d.promise()}function k(){var a=jQuery.Deferred(),f=b().id,g="DELETE",j=e("/auth/keys/"+f);return jQuery.ajax({dataType:"json",headers:d(j,g),type:g,url:e("/auth/keys/"+f),xhrFields:{withCredentials:!0}}).done(function(b){a.resolve(h(b))}).fail(function(b){a.reject(i(b))}).always(function(){return c({date:Date.now(),status:"logged out"})}),a.promise()}var l="COINS_AUTH_CREDENTIALS",m={baseUrl:""};return{getOptions:f,setOptions:g,login:j,logout:k}}),function(){"use strict";function a(b){return this instanceof a==!1?new a(b):(this.useDate=b===!0,void this.reset())}a.prototype.generate=function(){var a;return this.useDate===!1?this.previous++:(a=Date.now(),a<=this.previous?a=++this.previous:this.previous=a,a)},a.prototype.reset=function(){this.previous=0},"object"==typeof module&&"object"==typeof module.exports?module.exports=a:"function"==typeof define&&define.amd?define("unique-number",[],function(){return a}):window.UniqueNumber=a}(),function(a,b){"function"==typeof define&&define.amd?define("coins-logon-widget/scripts/lib/utils",["unique-number"],b):"object"==typeof module&&module.exports?module.exports=b(require("unique-number")):(a.CoinsLogonWidget=a.CoinsLogonWidget||{},a.CoinsLogonWidget.utils=b(a.UniqueNumber))}(this,function(a){"use strict";function b(a,b,c){function d(){c.apply(null,arguments),a.removeEventListener(b,d,!1)}a.addEventListener(b,d,!1)}function c(a){if(a)for(;a.lastChild;)a.removeChild(a.lastChild);a.parentNode&&a.parentNode.removeChild(a)}function d(a){return"string"!=typeof a&&(a=""),a+e.generate()}var e=new a;return{once:b,removeElement:c,uniqueId:d}}),function(a,b){"function"==typeof define&&define.amd?define("coins-logon-widget/scripts/lib/form-group",["es6-object-assign","./utils"],function(a,c){return b(a.assign,c)}):"object"==typeof module&&module.exports?module.exports=b(require("es6-object-assign").assign,require("./utils")):(a.CoinsLogonWidget=a.CoinsLogonWidget||{},a.CoinsLogonWidget.FormGroup=b(a.ObjectAssign.assign,a.CoinsLogonWidget.utils))}(this,function(a,b){"use strict";function c(b){b=b||{},this.options=a({},c.DEFAULTS,b),this.element=this._getElements(),this._setState()}return c.prototype._getElements=function(){var a=this.options.classNames,c=document.createElement("div"),d=b.uniqueId("coins-logon-widget-"),e=document.createElement("input"),f=document.createElement("label");return c.className=a.formGroup,f.className=a.label,f.setAttribute("for",d),f.textContent=this.options.labelText,e.className=a.input,e.id=d,e.name=this.options.inputName,e.type=this.options.type,this.options.hiddenLabel?(f.classList.add(a.hidden),e.placeholder=this.options.placeholder||this.options.labelText):(this.options.placeholder&&(e.placeholder=this.options.placeholder),this.options.required&&e.setAttribute("aria-required",!0)),c.appendChild(f),c.appendChild(e),c},c.prototype._setState=function(c){"undefined"==typeof this._state&&(this._state={});var d=this,e=this.element,f=this.options.classNames,g=e.querySelector("."+f.input),h=e.querySelector("."+f.icon),i=e.querySelector("."+f.message);a(this._state,c),this._state.message||this._state.error||this._state.success?(h||(h=document.createElement("span"),h.className=this.options.classNames.icon,h.setAttribute("aria-hidden",!0),e.appendChild(h)),!i&&this._state.message?(i=document.createElement("span"),i.className=this.options.classNames.message,e.appendChild(i)):this._state.message||i.parentNode.removeChild(i),i&&this._state.message&&(i.textContent=this._state.message),this._state.error?(e.classList.remove(f.success),e.classList.add(f.error)):this._state.success&&(e.classList.remove(f.error),e.classList.add(f.success)),b.once(g,"keydown",function(){d._setState({error:null,message:null,success:null})})):(h&&h.parentNode.removeChild(h),i&&i.parentNode.removeChild(i),e.classList.remove(f.error),e.classList.remove(f.success))},c.prototype.destroy=function(){b.removeElement(this.element),delete this._state,delete this.options},c.prototype.getName=function(){return this.options.inputName},c.prototype.getValue=function(){return this.element.querySelector("input").value},c.prototype.validate=function(){var a,b=this.getValue(),c=this.options.validate;return this.options.required&&c instanceof Function&&(a=c(b),a!==!0)?(this._setState({error:!0,message:a}),!1):!0},c.DEFAULTS={classNames:{error:"coins-logon-widget-form-group-error",formGroup:"coins-logon-widget-form-group",hidden:"coins-logon-widget-visuallyhidden",icon:"coins-logon-widget-icon",input:"coins-logon-widget-input",label:"coins-logon-widget-label",message:"coins-logon-widget-input-message",success:"coins-logon-widget-form-group-success"},hiddenLabel:!1,inputName:"name",labelText:"Name:",placeholder:"",required:!0,type:"text",validate:function(a){return""===a.trim()?"Field empty!":!0}},c}),function(a,b){"function"==typeof define&&define.amd?define("coins-logon-widget/scripts/lib/form",["es6-object-assign","./form-group","./utils"],function(a,c,d){return b(a.assign,c,d)}):"object"==typeof module&&module.exports?module.exports=b(require("es6-object-assign").assign,require("./form-group"),require("./utils")):(a.CoinsLogonWidget=a.CoinsLogonWidget||{},a.CoinsLogonWidget.Form=b(a.ObjectAssign.assign,a.CoinsLogonWidget.FormGroup,a.CoinsLogonWidget.utils))}(this,function(a,b,c){"use strict";function d(b){b=b||{},this.options=a({},d.DEFAULTS,b),this.element=this._getElements(),this._setState(this.options.initialState)}return d.prototype._getElements=function(){var a=document.createElement("button"),b=document.createElement("form");return b.className=this.options.classNames.form,this.options.horizontal&&b.classList.add(this.options.classNames.horizontal),b.method="post",b.addEventListener("submit",this._submitHandler.bind(this),!1),a.className=this.options.classNames.button+" "+this.options.classNames.right,a.type="submit",b.appendChild(this._getIndicatorElements()),b.appendChild(a),b},d.prototype._getIndicatorElements=function(){var a=document.createElement("div"),b=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=document.createElementNS("http://www.w3.org/2000/svg","title"),d=document.createElementNS("http://www.w3.org/2000/svg","circle"),e={cx:20,cy:20,r:8,fill:"none","stroke-width":2,"stroke-miterlimit":4};a.className=this.options.classNames.indicator,a.setAttribute("aria-hidden",!0),c.textContent="Loading…";for(var f in e)e.hasOwnProperty(f)&&d.setAttribute(f,e[f]);return b.appendChild(c),b.appendChild(d),a.appendChild(b),a},d.prototype._setState=function(b){"undefined"==typeof this._state&&(this._state={});var d=this,e=this.element.querySelector("."+this.options.classNames.button),f=this.element.querySelector("."+this.options.classNames.indicator),g=this.element.querySelector("."+this.options.classNames.notification),h=this.element.querySelector("."+this.options.classNames.status);a(this._state,b),g&&!b.notification?c.removeElement(g):!g&&b.notification&&(g=document.createElement("div"),g.className=this.options.classNames.notification,g.setAttribute("role","alert"),this.element.insertBefore(g,this.element.firstChild)),g&&b.notification&&(b.notification instanceof Node?g.appendChild(b.notification):g.innerHTML=b.notification,g.classList.remove(this.options.classNames.notificationError),g.classList.remove(this.options.classNames.notificationSuccess),b.error?g.classList.add(this.options.classNames.notificationError):b.success&&g.classList.add(this.options.classNames.notificationSuccess)),this._state.loading?(this.element.classList.add(this.options.classNames.loading),f.setAttribute("aria-hidden",!1)):(this.element.classList.remove(this.options.classNames.loading),f.setAttribute("aria-hidden",!0)),this._state.login?(this.formGroups||(this._setFormGroups(),this.formGroups.map(function(a){return a.element}).reverse().forEach(function(a){d.element.insertBefore(a,f)})),h&&this.element.removeChild(h),e.textContent=this.options.buttonLoginText,e.classList.remove(this.options.classNames.buttonSecondary),e.classList.add(this.options.classNames.buttonPrimary)):(this.formGroups&&this._removeFormGroups(),h||(h=document.createElement("p"),h.className=this.options.classNames.status,this.element.insertBefore(h,this.element.firstChild)),h.innerHTML=this._state.status||this.options.statusText,e.textContent=this.options.buttonLogoutText,e.classList.remove(this.options.classNames.buttonPrimary),e.classList.add(this.options.classNames.buttonSecondary))},d.prototype._submitHandler=function(a){a.preventDefault();var b=this.options.login,c=this.options.logout;this._state.login&&b instanceof Function?b(a):c instanceof Function&&c(a)},d.prototype._setFormGroups=function(){this.formGroups=this.options.formGroups.map(function(a){return new b(a)})},d.prototype._removeFormGroups=function(){this.formGroups.forEach(function(a){a.destroy()}),delete this.formGroups},d.prototype.clearMessage=function(){this._setState({error:null,notification:null,success:null})},d.prototype.destroy=function(){this.element.removeEventListener("submit",this._submitHandler,!1),c.removeElement(this.element),this._removeFormGroups(),delete this.options},d.prototype.getFormData=function(){return this.formGroups.reduce(function(a,b){var c=b.getName();return c in a||(a[c]=b.getValue()),a},{})},d.prototype.setErrorMessage=function(a){this._setState({error:!0,notification:a})},d.prototype.setLoading=function(){this._setState({loading:!0})},d.prototype.clearLoading=function(){this._setState({loading:!1})},d.prototype.setSuccessMessage=function(a){this._setState({notification:a,success:!0})},d.prototype.setToLogin=function(a){this._setState({login:!0})},d.prototype.setToLogout=function(a){this._setState({login:!1,status:a||null})},d.prototype.validate=function(){var a,b;return this.formGroups?(b=this.formGroups.map(function(a){return a.validate()}),a=b.every(function(a){return a===!0}),a?!0:b):void 0},d.DEFAULTS={buttonLoginText:"Log In",buttonLogoutText:"Log Out",classNames:{button:"coins-logon-widget-button",buttonPrimary:"coins-logon-widget-button-primary",buttonSecondary:"coins-logon-widget-button-secondary",form:"coins-logon-widget-form",horizontal:"coins-logon-widget-form-horizontal",indicator:"coins-logon-widget-indicator",loading:"coins-logon-widget-form-loading",notification:"coins-logon-widget-notification",notificationError:"coins-logon-widget-notification-error",notificationSuccess:"coins-logon-widget-notification-success",right:"coins-logon-widget-right",status:"coins-logon-widget-status"},initialState:{error:null,login:!0,notification:null,success:null},statusText:"Logged in"},d}),function(a,b){"function"==typeof define&&define.amd?define("coins-logon-widget/scripts/coins-logon-widget",["wolfy87-eventemitter/EventEmitter","es6-object-assign","./lib/auth","./lib/form","./lib/form-group"],function(a,c,d,e,f){return b(a,c.assign,d,e,f)}):"object"==typeof module&&module.exports?module.exports=b(require("wolfy87-eventemitter"),require("es6-object-assign").assign,require("./lib/auth"),require("./lib/form"),require("./lib/form-group")):a.CoinsLogonWidget=b(a.EventEmitter,a.ObjectAssign.assign,a.CoinsLogonWidget.Auth,a.CoinsLogonWidget.Form,a.CoinsLogonWidget.FormGroup)}(this,function(a,b,c,d,e){"use strict";function f(d,e){a.call(this),this.options=b({},f.DEFAULTS,e),(this.options.hiddenLabels||this.options.horizontal)&&this.options.formGroups.forEach(function(a){a.hiddenLabel=!0}),this.options.baseUrl&&c.setOptions({baseUrl:this.options.baseUrl}),this.element=this._getElements(d),this._setState()}var g={INVALID:"invalid",LOGIN:"login:init",LOGIN_ERROR:"login:error",LOGIN_SUCCESS:"login:success",LOGOUT:"logout:init",LOGOUT_ERROR:"logout:error",LOGOUT_SUCCESS:"logout:success"};return f.prototype=Object.create(a.prototype),f.prototype.constructor=f,f.prototype._getElements=function(a){if(!a)throw new Error("Element required");if(!(a instanceof Node))throw new Error("Expected element to be a DOM node");var b=this;return this.form=new d({formGroups:this.options.formGroups.reverse(),horizontal:this.options.horizontal,login:function(){b.emit(g.LOGIN,b.form.getFormData())},logout:function(){b.emit(g.LOGOUT)}}),a.innerHTML="",a.className=this.options.classNames.root,a.appendChild(this.form.element),a},f.prototype._setState=function(){this.on(g.LOGIN,this.login),this.on(g.LOGIN_ERROR,this.onError),this.on(g.LOGIN_SUCCESS,this.onLogin),this.on(g.LOGOUT,this.logout),this.on(g.LOGOUT_ERROR,this.onError),this.on(g.LOGOUT_SUCCESS,this.onLogout)},f.prototype.login=function(a){var b=this,d=b.form.validate();return d!==!0?void b.emit(g.INVALID,d):(b.form.clearMessage(),this.form.setLoading(),void c.login(a.username,a.password).done(function(a){b.form.clearLoading(),b.emit(g.LOGIN_SUCCESS,a)}).fail(function(a){b.form.clearLoading(),b.emit(g.LOGIN_ERROR,a)}))},f.prototype.logout=function(){var a=this;this.form.setLoading(),c.logout().done(function(b){a.form.clearLoading(),a.emit(g.LOGOUT_SUCCESS,b)}).fail(function(b){a.form.clearLoading(),a.emit(g.LOGOUT_ERROR,b)})},f.prototype.onError=function(a){var b;b="undefined"!=typeof a?a.message||a.toString():"Unknown error!",
this.form.setErrorMessage(b),console.error(a)},f.prototype.onLogin=function(a){var b=a.username,c=b?"Logged in as <strong>"+b+"</strong>.":"Logged in.";this.form.setToLogout(c)},f.prototype.onLogout=function(a){this.form.setToLogin()},f.prototype.onSubmit=function(a){a.preventDefault();var b;this.formGroups.forEach(function(a){var c=a.validate();c||(b=!0)}),b||(this.emit("submitted",a),this.login())},f.DEFAULTS={classNames:{root:"coins-logon-widget"},formGroups:[{inputName:"username",labelText:"Username:",placeholder:""},{inputName:"password",labelText:"Password:",placeholder:"",type:"password"}],hiddenLabels:!1,horizontal:!1},f});